# B. PRD（要件定義）

## 1. 機能要件（画面/機能 × 入出力）

| 機能 | 入力 | 処理 | 出力 |
|---|---|---|---|
| 接続設定 | Spreadsheet URL/ID、シート名 | 必須列チェック、接続テスト | 接続成功/失敗メッセージ |
| 商品一覧 | 検索語、フィルタ条件、並び順 | シート読込、条件適用、並び替え | 一覧表示、件数表示 |
| 商品登録 | 必須項目（例: 商品名、仕入日、仕入額など） | 商品No採番、入力検証、行追加 | 登録成功、登録データ反映 |
| 商品編集 | 商品No、更新項目 | 外部更新検知、入力検証、行更新 | 更新成功、差分反映 |
| アーカイブ | 商品No、アーカイブON/OFF | フラグ更新 | 一覧の除外/表示切替 |
| ダッシュボード | 集計期間、販売先条件 | 売上・仕入・利益を集計 | KPI表示、販売先別集計 |

## 2. 非機能要件

- 数千件規模で実用速度を維持する
- 主キー（商品No）重複を防止する
- 必須項目・型の入力バリデーションを行う
- 外部更新検知時は保存を停止し再読込を促す
- エラー時に原因をユーザーへ表示する
- API認証情報を安全に管理する
- 定期バックアップが可能な運用にする

## 3. 制約条件

- データベースはGoogleスプレッドシートのみ
- スプレッドシート直接編集を許容
- 同時編集は禁止（保存前に外部更新検知）
- MVPでは外部サービス連携を行わない
- 単一ユーザー運用を前提とする

## 4. 受け入れ条件（テスト観点）

| 観点 | チェック内容 | 合格条件 |
|---|---|---|
| 接続設定 | 正しいURL/IDで接続テスト | 成功メッセージが出る |
| 登録 | 商品を1件登録 | シートに新規行が追加される |
| 編集 | 既存商品を更新 | 対象行に更新が反映される |
| 競合制御 | 編集中にシートを外部更新 | 保存が停止され警告表示される |
| 一覧表示 | 検索/フィルタ/並び替え | 条件通りの結果が表示される |
| 集計 | 期間指定で集計実行 | シート値と一致する |
| エラー表示 | 接続エラー/入力不備 | 原因がユーザーに表示される |

